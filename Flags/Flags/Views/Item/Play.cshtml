@model Flags.Models.Quiz
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    var order = Model.getRandomOrder();
    int counter = 0;
    Model.getFullName("no");

    List<string[]> fullNames = new List<string[]>();

    for (int i = 0; i < order.Count(); i++)
    {
        fullNames.Add(Model.getFullName(order[i]));
    }
}

<div class="h-100">
    <div>
        <h2>@Html.DisplayFor(model => Model.Name)</h2>

    </div>
    <div>
        <div>
            <img src="" alt="Flag missing" id="img_flag" height="200" />
        </div>
        <div class="d-flex flex-row">
            <input type="text" name="inp_answer" placeholder="Which country..." id="inp_answer" class="input-group-text" />
            <input type="button" name="btn_answer" value="OK" id="btn_answer" class="btn btn-light" />
        </div>
    </div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript"></script>
<script>
    var orderJS = JSON.parse('@Html.Raw(Json.Serialize(order))');
    var fullNamesJS = JSON.parse('@Html.Raw(Json.Serialize(fullNames))');
    var currentFlag = 0;

    document.getElementById("img_flag").src = "https://toukerstorageaccount.blob.core.windows.net/flags/" + orderJS[currentFlag] + ".svg";

    function validateInput() {
        var answer = document.getElementById("inp_answer").value;

        if (answer != "") {
            answer = answer.toLowerCase();
            checkAnswer(answer);
        }
        else nextFlag();
    }

    function checkAnswer(a) {
        for (var i = 1; i < fullNamesJS[currentFlag].length; i++) {
            if (document.getElementById("inp_answer").value == fullNamesJS[currentFlag][i]) {
                console.log("correct");
                nextFlag();
            }
            else console.log("incorrect");
        }
    }

    function nextFlag() {
        if (currentFlag + 1 == orderJS.length) return null;
        currentFlag++;
        document.getElementById("img_flag").src = "https://toukerstorageaccount.blob.core.windows.net/flags/" + orderJS[currentFlag] + ".svg";
        document.getElementById("inp_answer").value = "";
    }

    document.addEventListener("keypress", function (e) {
        if (e.keyCode == 13) {
            validateInput();
        }
    });

    document.getElementById("btn_answer").addEventListener("click", function (e) {
        validateInput();
    });
</script>