@model Flags.Models.Quiz
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    var order = Model.getRandomOrder();
    int counter = 0;
    var masterKey = "QR9M7wX2mZyCh0eCMZc8WcI3Mug0bkDVwS9Fi2lxMfmHJ6745aaUHS6O6WepgV01hUKBT471845jdglwDuLg5A==";

}

<div class="h-100">
    <div>
        <h2>@Html.DisplayFor(model => Model.Name)</h2>

    </div>
    <div>
        <div>
            <img src="" alt="Flag missing" id="img_flag" height="200"/>
        </div>
        <div class="d-flex flex-row">
            <input type="text" name="inp_answer" placeholder="Which country..." id="inp_answer" class="input-group-text" />
            <input type="button" name="btn_answer" value="OK" id="btn_answer" class="btn btn-light" />
        </div>
    </div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript"></script>
<script>
    document.getElementById("img_flag").src = "https://toukerstorageaccount.blob.core.windows.net/flags/@(order[counter]).svg";

    function validateInput() {
        var answer = document.getElementById("inp_answer").value;

        if (answer != "") {
            answer = answer.toLowerCase();
            checkAnswer(answer);
        }
        else nextFlag();
    }

    function checkAnswer(a) {
        $.ajax({
            type: "GET",
            url: "https://toukerdb.documents.azure.com:443/dbs/flagdatabase/colls/Countries/",
            dataType: "json",
            headers: {
                "Content-Type": "application/query+json",
                "Authorization": "@Model.GenerateAuthToken("GET", "colls", "dbs/flagdatabse/colls/Countries", DateTime.UtcNow.ToShortDateString(), masterKey, "master", "1.0")"
            },
            success: function (data) {
                alert("it works");
            }
        });
        var names = JSON.parse('@Html.Raw(Json.Serialize(Model.getFullName(order[counter])))');
        for (var i = 0; i < names.length; i++) {
            if (document.getElementById("inp_answer").value == names[i]) {
                alert("correct");
            }
            else alert("incorrect");
        }
    }

    function nextFlag() {
        $.ajax({
            url: '@Url.Action("GetNames", "Item")',
            data: { data: "se" },
            dataType: "json",
            success: function (data) {
                alert("it works: " + data);
            }
        });
        @(Model.Counter = 2)
        console.log("@(Model.Counter) + @counter");

        document.getElementById("img_flag").src = "https://toukerstorageaccount.blob.core.windows.net/flags/@(order[counter]).svg";
        document.getElementById("inp_answer").value = "";
    }

    document.addEventListener("keypress", function (e) {
        if (e.keyCode == 13) {
            validateInput();
        }
    });

    document.getElementById("btn_answer").addEventListener("click", function (e) {
        validateInput();
    });
</script>